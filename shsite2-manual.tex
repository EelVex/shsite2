\documentclass{memoir}

\title{shsite2 manual}
\author{eelvex}
\date{\today}

\newcommand{\var}[1]{\texttt{\%\{#1\}\%}}

\makeglossary

\begin{document}
\begin{titlingpage}
\maketitle
\end{titlingpage}
\tableofcontents

\chapter{How it works} % {{{

\section{variables, parse-commands and functions} % {{{

	Define variable or function: ``- key:''

	Variables: \var{name}

	Functions: \var{name: args}

	Parse-Commands: \var{!command}

	Includes:  \var{@file}

	Any nest level:

	\var{name-\var{!com: args}-\var{@\var{!echo "file"}} }
	will first run command ``com'' with arguments ``args'', then will run ``echo "file"'', will include ``file''
	which will make the name of the variable: ``name-xxx-xxx''

% }}} variables, commands and functions


\section{Makefile} % {{{

Makefile variables:
\begin{description}
\item[\texttt{SITE\_sources}:] files to be parsed
\item[\texttt{SITE\_files}:] files to be used as is (copied)
\item[\texttt{SITE\_target\_dir}:] output directory for this site. Default value is \texttt{SITE/}
\item[\texttt{SITE\_indexes}:] files used for indexing and site-map. Default value is to point to \texttt{SITE\_sources}.
\end{description}

Dynamic template with default, example
\tabson
\begin{verbatim}
define eelvex.net_rule =
	@echo "Building ${2}"
	@mkdir -p $$(dirname ${2})
	@template=$$(shsite2 get-key ${1} template); \
		shsite2 parse preconfig.slc ${1} $${template:-template.html} | shsite2 parse postconfig.slc > ${2}
endef
\end{verbatim}


% }}} makefile


% }}}

\chapter{Commands} % {{{

	\section{\emph{make}} % {{{
	make [site]

	Invoke gnu-make command after some basic checks.

	A default Makefile is provided that is supposed to build a site from your sources.
	% }}}
	\section{\emph{publish}} % {{{
	publish [site]

	Publish your site through rsync,git,(s)ftp or other user-specified method.
	\section{\emph{info}}
	info <path | name | fullpathname | title | depends> <file>

	Get relevant info from file.
	% }}}
	\section{get-key}
	\section{blocks}
	\section{block-put}
	\section{parse}

% }}} commands

\chapter{parse-commands} % {{{
	%{{{
	Use the first line on commands that take multi-line input, for options.
	Separate options with spaces.

	\glossary{SHS2_PARSE_COMMANDS_PATH}{Path for default shs2 parse-commands}
	and \glossary{USER_PARSE_COMMANDS_PATH}{Path for user shs2 parse-commands} configuration variables point to paths where 
	parse-commands reside (default and user respectively).
	% }}}

	\section{table-tex}
	\section{code}

% }}} parse-commands

\chapter{standard library functions} % {{{
\var{@stdfunctions}
\section{map}
\var{map: '\var{func}' arg1 arg2 'arg3-a arg3-b' \ldots}

is the same as:\\
\var{func: arg1}\\
\var{func: arg2}\\
\var{func: arg3-a arg3-b}\\
\ldots

% }}}

\chapter{Usage}
\chapter{Examples}

\printglossary

\end{document}
